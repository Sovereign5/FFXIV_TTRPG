<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css?family=Bebas+Neue&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Romanesco&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Jura:wght@300..700&display=swap" rel="stylesheet">

<input type="text" name="attr_char_modifier" hidden>

<div class="page">
	<div class="headerbar">
		<img src="https://raw.githubusercontent.com/Sovereign5/FFXIV_TTRPG/main/images/logo_text.png" />
		<div class="headerbar-right">
			<input type="text" name="attr_character_name" style="position: relative; font-size: 24px; font-family: Jura; background-color: transparent; appearance: none; border: none; color: white; width: 255px;">
			<hr style="width: 255px; position: relative; right: 150px; bottom: 24px; border-top: 2px solid white;">
		</div>
	</div>

	<!-- ROLE BAR + HP + MP -->
	<div class="rolebar">
		<div class="rolebar-left">
			<!-- ROLE SELECTION -->
			<div class="stacking-element-font" style="position: relative; top: 8px">
				<span style="position: relative; right: 60px">ROLE</span>
				<span style="position: relative; left: 15px;">JOB</span>
			</div>
			<div>
				<span style="position: relative; font-size: 20px;">LV</span>
				<input type="number" name="attr_char_level" step="10" min="0" max="50" style="position: relative; bottom: 6px; text-decoration: underline;">
				<select name="attr_class" style="position: relative; width: 280px; height: 40px; font-size: 24px; font-weight: 600;">
					<option style="color: black;" value="-1">Select</option>
					<option style="color: black;" value="Paladin">Tank / Paladin</option>
					<option style="color: black;" value="Warrior">Tank / Warrior</option>
					<option style="color: black;" value="DarkKnight">Tank / Dark Knight</option>
					<option style="color: black;" value="Gunbreaker">Tank / Gunbreaker</option>
					<option style="color: black;" value="WhiteMage">Healer / White Mage</option>
					<option style="color: black;" value="Scholar">Healer / Scholar</option>
					<option style="color: black;" value="Astrologian">Healer / Astrologian</option>
					<option style="color: black;" value="Sage">Healer / Sage</option>
					<option style="color: black;" value="Monk">DPS / Monk</option>
					<option style="color: black;" value="Dragoon">DPS / Dragoon</option>
					<option style="color: black;" value="Ninja">DPS / Ninja</option>
					<option style="color: black;" value="Samurai">DPS / Samurai</option>
					<option style="color: black;" value="Reaper">DPS / Reaper</option>
					<option style="color: black;" value="Bard">DPS / Bard</option>
					<option style="color: black;" value="Machinist">DPS / Machinist</option>
					<option style="color: black;" value="Dancer">DPS / Dancer</option>
					<option style="color: black;" value="BlackMage">DPS / Black Mage</option>
					<option style="color: black;" value="Summoner">DPS / Summoner</option>
					<option style="color: black;" value="RedMage">DPS / Red Mage</option>
					<option style="color: black;" value="BlueMage">DPS / Blue Mage</option>
				</select>
			</div>
			
		</div>

		<div class="rolebar-middle">
			<!-- HP BAR -->
			<span style="font-size: 2em; position: relative; left: 18px">HP</span>
			<input type="number" name="attr_char_HP" min="0" style="position: relative; left: 18px; width: 80px; height: 60px; font-size: 50px;">
			<span class="dividing-line" style="position: relative;">/</span>
			<div class="stacking-element">
				<span class="stacking-element-font" style="position: relative; right: 8px">MAX</span>
				<input type="number" name="attr_char_maxHP" min="0" style="position: relative; left: 2px">
			</div>
			<span class="dividing-line" style="position: relative; right: 13px">|</span>
			<div class="stacking-element">
				<span class="stacking-element-font" style="position: relative; right: 12px">BARRIER</span>
				<input type="number" name="attr_char_tempHP" min="0" style="position: relative; left: 5px;">
			</div>
		</div>

		<div class="rolebar-right">
			<!-- MP BAR -->
			<span style="font-size: 2em;">MP</span>
			<input type="number" name="attr_char_MP" min="0" max="5" style="position: relative; width: 45px; height: 60px; font-size: 50px;"/>
			<span class="dividing-line" style="position: relative; right: 13px">/</span>
			<div class="stacking-element" style="position: relative; right: 5px">
				<span class="stacking-element-font">MAX</span>
				<span>5</span>
			</div>
		</div>
	</div>
	<!-- END OF ROLE BAR + HP + MP -->

	<!-- THE BODY -->
	<div class="body">
		<div class="body-left">
			<div class="grid-item" style="position: relative; top: 13px;">
				<label>Main Status</label>
				<hr style="position: relative; bottom: 19px;">
			</div>
			<div class="grid-item" style="position: relative; top: 13px;">
				<label>Sub Status</label>
				<hr style="position: relative; bottom: 19px; width: 88%; right: 10px;">
			</div>
			<div class="grid-item">
				<div class="grid-rollable">
					<span>STR</span>
					<input type="number" name="attr_char_strength">
					<button type='roll' value="/roll 1d20 + @{char_strength}" name=roll_strCheck></button>
					<hr>
				</div>
			</div>
			<div class="grid-item">
				<span class="span-longer">Defense</span>
				<input class="input-shorter" type="number" name="attr_physical_defense" value="10" readonly>
				<hr style="width: 88%; position: relative; right: 10px; bottom: 25px;">
			</div>
			<div class="grid-item">
				<div class="grid-rollable">
					<span>DEX</span>
					<input type="number" name="attr_char_dexterity">
					<button type='roll' value="/roll 1d20 + @{char_dexterity}" name=roll_dexCheck></button>
					<hr>
				</div>
			</div>
			<div class="grid-item">
				<span class="span-longer">M. Defense</span>
				<input class="input-shorter" type="number" name="attr_magical_defense" value="10" readonly>
				<hr style="width: 88%; position: relative; right: 10px; bottom: 25px;">
			</div>
			<div class="grid-item">
				<div class="grid-rollable">
					<span>VIT</span>
					<input type="number" name="attr_char_vitality">
					<button type='roll' value="/roll 1d20 + @{char_vitality}" name=roll_vitCheck></button>
					<hr>
				</div>
			</div>
			<div class="grid-item">
				<span class="span-longer">Vigilance</span>
				<input class="input-shorter" type="number" name="attr_char_vigilance" readonly />
				<hr style="width: 88%; position: relative; right: 10px; bottom: 25px;">
			</div>
			<div class="grid-item">
				<div class="grid-rollable">
					<span>INT</span>
					<input type="number" name="attr_char_intelligence">
					<button type='roll' value="/roll 1d20 + @{char_intelligence}" name=roll_intCheck></button>
					<hr>
				</div>
			</div>
			<div class="grid-item">
				<span class="span-longer" style="width: 55px">Speed</span>
				<span class="input-shorter" style="position: relative; right: 10px">5</span>
				<span class="input-shorter" style="font-size: 14px; position: relative; right:15px">squares</span>
				<hr style="width: 88%; position: relative; right: 10px; bottom: 24px;">
			</div>
			<div class="grid-item">
				<div class="grid-rollable">
					<span>MND</span>
					<input type="number" name="attr_char_mind">
					<button type='roll' value="/roll 1d20 + @{char_mind}" name=roll_mndCheck></button>
					<hr>
				</div>
			</div>
			<!-- Purposefully Left Empty for Spacing -->
			<div class="grid-item"></div>
		</div>
		<div class="body-right">
			<label>Traits & Other Effects</label>
			<input type="checkbox" name="attr_traitswitch" class="sheet-traits-switch" value="1" hidden>
			<button type="action" name="act_traitedit" class="edittraitbutton">Toggle</button>
			<textarea name="attr_traitsandeffects" class="sheet-traits-show" style="position: relative; top: 5px;"></textarea>
			<!-- <span style="position: relative; left: 5px" name="attr_traitsandeffects" class="sheet-traits-hide"></span> -->
			<textarea name="attr_traitsandeffects" class="sheet-traits-hide lockedtextarea" style="position: relative; top: 5px; background-color: transparent; color: white; resize: none; pointer-events: none;" readonly></textarea>
		</div>
	</div>
</div>


<!-- OLD CHARACTER SHEET INFORMATION  -->
<div name="char_name_box">
	<span>Character Name</span>
	<input type="text" name="attr_character_name">
</div>
Level<input type="number" name="attr_char_level" step="10" min="0" max="50">

HP<input type="number" name="attr_char_HP" min="0"/>
MaxHP<input type="number" name="attr_char_maxHP" min="0"/>
Temp HP<input type="number" name="attr_temp_hp" min="0">

MP<input type="number" name="attr_char_MP" min="0" max="5"/>
MaxMP<input type="number" name="attr_char_maxMP" value="5" readonly/>
<br>
<div name="Role Selection">
	<select name="attr_class">
		<option value="-1">Select</option>
		<option value="0">Paladin</option>
		<option value="1">Warrior</option>
		<option value="2">Dark Knight</option>
		<option value="3">Gunbreaker</option>
		<option value="4">Monk</option>
		<option value="5">Dragoon</option>
		<option value="6">Ninja</option>
		<option value="7">Samurai</option>
		<option value="8">Reaper</option>
		<option value="9">White Mage</option>
		<option value="10">Scholar</option>
		<option value="11">Astrologian</option>
		<option value="12">Sage</option>
		<option value="13">Bard</option>
		<option value="14">Machinist</option>
		<option value="15">Dancer</option>
		<option value="16">Black Mage</option>
		<option value="17">Summoner</option>
		<option value="18">Red Mage</option>
		<option value="19">Blue Mage</option>
	</select>
	<span>Role</span>
	<input type="text" name="attr_role" readonly>
</div>
<br>
<br>
STR<input type="number" name="attr_char_strength"/>
<button type='roll' value="/roll 1d20 + @{char_strength}" name=roll_strCheck>STR</button>
<br>
DEX<input type="number" name="attr_char_dexterity"/>
<button type='roll' value='/roll 1d20 + @{char_dexterity}' name=roll_strCheck>DEX</button>
<br>
VIT<input type="number" name="attr_char_vitality"/>
<button type='roll' value='/roll 1d20 + @{char_vitality}' name=roll_strCheck>VIT</button>
<br>
INT<input type="number" name="attr_char_intelligence"/>
<button type='roll' value='/roll 1d20 + @{char_intelligence}' name=roll_strCheck>INT</button>
<br>
MND<input type="number" name="attr_char_mind"/>
<button type='roll' value='/roll 1d20 + @{char_mind}' name=roll_strCheck>MND</button>
<br>
<br>
<span>Physical Defense</span>
<input type="number" name="attr_physical_defense" value="10" readonly>
<br>
<span>Magical Defense</span>
<input type="number" name="attr_magical_defense" value="10" readonly>
<br>
Vigilance<input type="number" name="attr_char_vigilance" readonly />
<br>
<span>Movement Squares</span>
<input type="number" name="attr_movement">
<br>
<br>
<h2>Primary Abilities</h2>
<fieldset class="repeating_primaryability">
	<span>Ability Name</span>
	<input type="checkbox" class="sheet-block-switch" name="attr_blockswitch" value="1" hidden>


	<input type="text" name="attr_abilityname" class="sheet-block-a" placeholder="Storm's Path">
	<button type='roll' value="&{template:ffxivmain} {{rolltype=@{abilityselector} }} {{name=@{abilityname} }} {{tags=@{tags} }} {{basedamage=@{abilityBaseEffectNumber} }} {{directdamage=[ROLL DIRECT HIT](~repeating_primaryability_directDamageRoll) }} {{effect=@{abilityBaseEffectDescription} }} {{Attack = [[@{abilityselector}]]}}" name="roll_abilityCheckSelector" class="sheet-block-b"><span name="attr_abilityname"></span></button>
	<br>

	<span>Tags</span>
	<div class="sheet-block-a">
		<div >
			<span>Physical</span>
			<input type="checkbox" name="attr_tagphysical" value="Physical">
		</div>
		<div>
			<span>Magical</span>
			<input type="checkbox" name="attr_tagmagical" value="Magical">
		</div>
		<div>
			<span>Ice</span>
			<input type="checkbox" name="attr_tagice" value="Ice">
		</div>
		<div>
			<span>Fire</span>
			<input type="checkbox" name="attr_tagfire" value="Fire">
		</div>
		<div>
			<span>Thunder</span>
			<input type="checkbox" name="attr_tagthunder" value="Thunder">
		</div>
	</div>
	<input type="text" name="attr_tags" class="sheet-block-b" class="sheet-block-b" readonly>
	<br>

	<span>Target:</span>
	<input type="text" name="attr_abilitytarget" class="sheet-block-a" placeholder="Single">
	<span name="attr_abilitytarget" class="sheet-block-b"></span>
	<br>

	<span>Range:</span>
	<input type="number" name="attr_abilityrange" min=1 class="sheet-block-a" placeholder="5">
	<span class="sheet-block-b" name="attr_abilityrange"></span>
	<br>

	<span>Check:</span>
	<span>Ability Modifier: </span>
	<input type="text" name="attr_convertedAbilityCheckSelector" hidden>
	<span class="sheet-block-b" name="attr_convertedAbilityCheckSelector"></span>
	<select class="sheet-block-a" name="attr_abilityselector">
		<option value="1d20 + @{char_strength}">STR</option>
		<option value="1d20 + @{char_dexterity}">DEX</option>
		<option value="1d20 + @{char_intelligence}">INT</option>
		<option value="1d20 + @{char_mind}">MND</option>
	</select>
	<button class="hide" type="roll" name="roll_directDamageRoll" value="&{template:ffxivdamage} {{name=@{abilityname} }} {{Attack = [[@{abilityDirectHit}]] }}">Hide</button>
	<br>

	<span>CR:</span>
	<input type="text" name="attr_abilitycr" class="sheet-block-a" placeholder="Target's P. Defense">
	<span class="sheet-block-b" name="attr_abilitycr"></span>
	<br>

	<span>Base Effect:</span>
	<br>
	<span>Damage:</span>
	<input type="number" name="attr_abilityBaseEffectNumber" class="sheet-block-a" placeholder="2">
	<span name="attr_abilityBaseEffectNumber" class="sheet-block-b"></span>
	<span>Effect:</span>
	<input type="text" name="attr_abilityBaseEffectDescription" class="sheet-block-a" placeholder="Inflicts Enmity to the target. Combo: Storm's Path">
	<span name="attr_abilityBaseEffectDescription" class="sheet-block-b"></span>
	<span>Direct Hit:</span>
	<input type="text" name="attr_abilityDirectHit" class="sheet-block-a" placeholder="1d6.">
	<span name="attr_abilityDirectHit" class="sheet-block-b"></span>
	</div>
	<br>
	<button type="action" class="toggle_repeating_npcaction_edit" name="act_edit">Edit Toggle</button>
</fieldset>
<br>


<h2>Secondary Abilities</h2>
<fieldset class="repeating_secondaryability">
	<span>Ability Name</span>
	<input type="checkbox" class="sheet-block-switch" name="attr_blockswitch" value="1" hidden>
	<input type="text" name="attr_abilityname" placeholder="Rampart" class="sheet-block-a">
	<span name="attr_abilityname" class="sheet-block-b"></span>
	<br>
	<span>Secondary, </span>
	<select name="attr_abilitydamagetype" class="sheet-block-a">
		<option value="Physical">Physical</option>
		<option value="Magical">Magical</option>
	</select>
	<span name="attr_abilitydamagetype" class="sheet-block-b"></span>
	<br>
	<span>Target:</span>
	<input type="text" name="attr_abilitytarget" class="sheet-block-a" placeholder="Self">
	<span name="attr_abilitytarget" class="sheet-block-b"></span>
	<!-- Exclude if nothing is here -->
	<span>Range:</span>
	<input type="number" name="attr_abilityrange" min=1 class="sheet-block-a" placeholder="1">
	<span name="attr_abilityrange" class="sheet-block-b"></span>
	<br>
	<span>Base Effect:</span>
	<input type="text" name="attr_abilitybaseeffect" class="sheet-block-a" placeholder="Reduce the damage you take from all abilities by 2 until the start of your next turn.">
	<span name="attr_abilitybaseeffect" class="sheet-block-b"></span>
	<br>
	<span>Limitation:</span>
	<input type="text" name="attr_abilitydirecthit" class="sheet-block-a" placeholder="Once per Phase">
	<span name="attr_abilitydirecthit" class="sheet-block-b"></span>
	<br>
	<button type="action" class="toggle_repeating_npcaction_edit" name="act_edit">Edit Toggle</button>
</fieldset>
<br>


<h2>Reaction Abilities</h2>
<fieldset class="repeating_reactionability">
	<span>Ability Name</span>
	<input type="checkbox" class="sheet-block-switch" name="attr_blockswitch" value="1" hidden>
	<input type="text" name="attr_abilityname" class="sheet-block-a" placeholder="Reprisal">
	<span class="sheet-block-b" name="attr_abilityname"></span>
	<br>
	<span>Reaction</span>
	<br>
	<span>Trigger:</span>
	<input type="text" name="attr_abilitytrigger" class="sheet-block-a" placeholder="Immediately before an ability used by an enemy within 2 squares is resolved.">
	<span name="attr_abilitytrigger" class="sheet-block-b"></span>
	<span>Target:</span>
	<input type="text" name="attr_abilitytarget" class="sheet-block-a" placeholder="All enemies within range.">
	<span name="attr_abilitytarget" class="sheet-block-b"></span>
	<span>Range:</span>
	<input type="number" name="attr_abilityrange" min=1 class="sheet-block-a" placeholder="5">
	<span name="attr_abilityrange" class="sheet-block-b"></span>
	<br>
	<span>Base Effect:</span>
	<input type="text" name="attr_abilitybaseeffect" class="sheet-block-a" placeholder="Reduce the damage you take from all abilities by 2 until the start of your next turn.">
	<span class="sheet-block-b" name="attr_abilitybaseeffect"></span>
	<br>
	<span>Limitation:</span>
	<input type="text" name="attr_abilitydirecthit" class="sheet-block-a" placeholder="Once per turn.">
	<span name="attr_abilitydirecthit" class="sheet-block-b"></span>
	<br>
	<button type="action" class="toggle_repeating_npcaction_edit" name="act_edit">Edit Toggle</button>
</fieldset>

<!-- Roll Template in FFXIV Style -->
<rolltemplate class="sheet-rolltemplate-ffxivmain">
	<div class="sheet-template-container">
		<div class="sheet-template-masterheader">
			<div class=sheet-template-header>
				{{#name}}
				<div class="sheet-header">{{name}}</div>
				{{/name}}
			</div>
			<div class="sheet-template-row">
				{{#tags}}
				<div class="sheet-tags">{{tags}}</div>
				{{/tags}}
			</div>
		</div>
		<hr class="sheet-line">
		<div class="sheet-template-header">
			{{#allprops() rolltype name tags basedamage directdamage effect}}
    		<div class="sheet-value">{{value}}</div>
 			{{/allprops() rolltype name tags basedamage directdamage effect}}
 			<div class="sheet-info">
 				<!-- {{#rolltype}} <div>{{rolltype}}</div> {{/rolltype}} -->
 				<span>ABILITY CHECK</span>
 			</div>
		</div>
		<hr class="sheet-line">
		<div class="sheet-template-header">
			<div class="sheet-value">
				{{#basedamage}}
				<span class="inlinerollresult" style="color:white;font-family: 'Bebas Neue, sans-serif';padding-bottom:'2px">{{basedamage}}</span>
				{{/basedamage}}
			</div>
			<div class="sheet-info">
				<span>DAMAGE</span>
			</div>
		</div>
		{{#effect}}
		<div class="sheet-template-row">
			<div class="sheet-tags">{{effect}}</div>
		</div>
		{{/effect}}
		<hr class="sheet-line">
		{{directdamage}}
	</div>
</rolltemplate>

<!-- Damage Roll Template in FFXIV Style -->
<rolltemplate class="sheet-rolltemplate-ffxivdamage">
	<div class="sheet-template-container">
		<div class="sheet-template-header">
			{{#name}}
			<div class="sheet-header">{{name}}</div>
			{{/name}}
		</div>
		<div class="sheet-template-row">
			<div class="sheet-tags">DIRECT HIT</div>
		</div>
		<hr class="sheet-line">
		<div class="sheet-template-header">
			{{#allprops() name}}
			<div class="sheet-value">{{value}}</div>
			{{/allprops() name}}
		</div>
		<div class="sheet-template-row">
			<div class="sheet-tags-2">DAMAGE</div>
		</div>
	</div>
</rolltemplate>




<script type="text/worker">
	// Adjusts vigilance stat as mind stat changes
	on("change:char_mind", function() {
		getAttrs(["char_mind"], function(values) {
			let mind = parseInt(values.char_mind)||0;

			let vigil = 10 + mind;

			setAttrs({
				char_vigilance: vigil
			});
		});
	});

	// Change Physical & Magical deefnse as class changes
	on("change:class", function() {
		getAttrs(["class"], function(value) {
			let newClassValue = value.class;
			let newPhysicalDefense = 10;
			let newMagicalDefense = 10;
			let newRole = "";
			let newModifier = "";

			switch (newClassValue) {
				case "Paladin": // Paladin
					newPhysicalDefense = 16;
					newMagicalDefense = 13;
					newRole = "Tank";
					newModifier = "@{char_strength}";
					break;
				case "Warrior": // Warrior
					newPhysicalDefense = 15;
					newMagicalDefense = 13;
					newRole = "Tank";
					newModifier = "@{char_strength}";
					break;
				case "DarkKnight": // Dark Knight
					newPhysicalDefense = 15;
					newMagicalDefense = 14;
					newRole = "Tank";
					newModifier = "@{char_strength}";
					break;
				case "Gunbreaker": // Gunbreaker
					newPhysicalDefense = 13;
					newMagicalDefense = 13;
					newRole = "Tank";
					newModifier = "@{char_strength}";
					break;
				case "Monk": // Monk
					newPhysicalDefense = 13;
					newMagicalDefense = 13;
					newRole = "Damage Dealer";
					newModifier = "@{char_strength}";
					break;
				case "Dragoon": // Dragoon
					newPhysicalDefense = 15;
					newMagicalDefense = 12;
					newRole = "Damage Dealer";
					newModifier = "@{char_strength}";
					break;
				case "Ninja": // Ninja
					newPhysicalDefense = 13;
					newMagicalDefense = 13;
					newRole = "Damage Dealer";
					newModifier = "@{char_strength}";
					break;
				case "Samurai": // Samurai
					newPhysicalDefense = 13;
					newMagicalDefense = 13;
					newRole = "Damage Dealer";
					newModifier = "@{char_strength}";
					break;
				case "Reaper": // Reaper
					newPhysicalDefense = 13;
					newMagicalDefense = 13;
					newRole = "Damage Dealer";
					newModifier = "@{char_strength}";
					break;
				case "WhiteMage": // White Mage
					newPhysicalDefense = 11;
					newMagicalDefense = 14;
					newRole = "Healer";
					newModifier = "INT";
					break;
				case "Scholar": // Scholar
					newPhysicalDefense = 13;
					newMagicalDefense = 13;
					newRole = "Healer";
					newModifier = "INT";
					break;
				case "Astrologian": // Astrologian
					newPhysicalDefense = 13;
					newMagicalDefense = 13;
					newRole = "Healer";
					newModifier = "INT";
					break;
				case "Sage": // Sage
					newPhysicalDefense = 13;
					newMagicalDefense = 13;
					newRole = "Healer";
					newModifier = "INT";
					break;
				case "Bard": // Bard
					newPhysicalDefense = 13;
					newMagicalDefense = 13;
					newRole = "Damage Dealer";
					newModifier = "DEX";
					break;
				case "Machinist": // Machinist
					newPhysicalDefense = 13;
					newMagicalDefense = 13;
					newRole = "Damage Dealer";
					newModifier = "DEX";
					break;
				case "Dancer": // Dancer
					newPhysicalDefense = 13;
					newMagicalDefense = 13;
					newRole = "Damage Dealer";
					newModifier = "DEX";
					break;
				case "BlackMage": // Black mage
					newPhysicalDefense = 11;
					newMagicalDefense = 15;
					newRole = "Damage Dealer";
					newModifier = "INT";
					break;
				case "Summoner": // Summoner
					newPhysicalDefense = 13;
					newMagicalDefense = 13;
					newRole = "Damage Dealer";
					newModifier = "INT";
					break;
				case "RedMage": // Red Mage
					newPhysicalDefense = 13;
					newMagicalDefense = 13;
					newRole = "Damage Dealer";
					newModifier = "INT";
					break;
				case "BlueMage": // Blue Mage
					newPhysicalDefense = 9;
					newMagicalDefense = 9;
					newRole = "Limited";
					newModifier = "INT";
					break;
				default:
			}

			setAttrs({
				"physical_defense": newPhysicalDefense,
				"magical_defense": newMagicalDefense,
				"role": newRole,
				"char_modifier": newModifier
			});
		});
	});

	// Edit Button Functionality (For Primary)
	on("clicked:repeating_primaryability:edit", function() {
		getAttrs(["repeating_primaryability_abilityname", "repeating_primaryability_blockswitch", "repeating_primaryability_tagphysical", "repeating_primaryability_tagmagical", "repeating_primaryability_tagice", "repeating_primaryability_tagfire", "repeating_primaryability_tagthunder"], function(values) {
			let name = values.repeating_primaryability_abilityname;
			let switchToggle = values.repeating_primaryability_blockswitch;
			switchToggle = 1 - switchToggle;

			// Tag Builder
			var tags = [];
			tags.push(values.repeating_primaryability_tagphysical, values.repeating_primaryability_tagmagical, values.repeating_primaryability_tagice, values.repeating_primaryability_tagfire, values.repeating_primaryability_tagthunder);
			tags = removeItemAll(tags, "0")
			tags.unshift("Primary")
			const tagString = tags.join(', ');

			setAttrs({
				repeating_primaryability_blockswitch: switchToggle,
				repeating_primaryability_tags: tagString
			});
		});
	});

	// Edit Button Functionality (For Secondary)
	on("clicked:repeating_reactionability:edit", function() {
		getAttrs(["repeating_reactionability_abilityname", "repeating_reactionability_blockswitch"], function(values) {
			let name = values.repeating_reactionability_abilityname;
			let switchToggle = values.repeating_reactionability_blockswitch;
			switchToggle = 1 - switchToggle;
			setAttrs({
				repeating_reactionability_blockswitch: switchToggle
			});
		});
	});

	// Edit Button Functionality (For Reaction)
	on("clicked:repeating_secondaryability:edit", function() {
		getAttrs(["repeating_secondaryability_abilityname", "repeating_secondaryability_blockswitch"], function(values) {
			let name = values.repeating_secondaryability_abilityname;
			let switchToggle = values.repeating_secondaryability_blockswitch;
			switchToggle = 1 - switchToggle;
			setAttrs({
				repeating_secondaryability_blockswitch: switchToggle
			});
		});
	});

	// Checkbox for Attack
	on("clicked:repeating_primaryability:attackcheckbox", function() {
		getAttrs(["repeating_primaryability_attackcheckbox"], function(values) {
			let switchToggle = values.repeating_primaryability_attackcheckbox;
			switchToggle = 1 - switchToggle;
			setAttrs({
				repeating_primaryability_attackcheckbox: switchToggle
			});
		});
	});

	// Toggle for Traits & Other Effects
	on("clicked:traitedit", function() {
		getAttrs(["traitswitch"], function(values) {
			let switchToggle = values.traitswitch;
			switchToggle = 1 - switchToggle;
			setAttrs({
				traitswitch: switchToggle
			});
		});
	});

	function removeItemAll(arr, value) {
	  var i = 0;
	  while (i < arr.length) {
	    if (arr[i] === value) {
	      arr.splice(i, 1);
	    } else {
	      ++i;
	    }
	  }
	  return arr;
	}

</script>
